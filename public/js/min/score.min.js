function createPlotData(c){var a=["#FF9516","#C6C6C6"];var b=c.reduce(function(d,f){return parseInt(d)+parseInt(f)});return $(c).map(function(f,e){var d=((b>0)?Math.round((e*100)/b):50).toString()+"%";var g=(b>0)?Math.floor((e*360)/b):180;(g<80)&&(g=80);(g>280)&&(g=280);return{degrees:g,percentage:d,color:a[f]}})}function createPointer(a){var c={};var b=90;c.degrees=function(){return b};c.move=function(d){b+=(a?d:-d);return b};c.reset=function(){b=90;return b};c.clockwise=function(){return a};return c}createChart=function(f){var i={};var c=f.canvas();var b=c.getContext("2d");var a={x:Math.floor(c.width/2),y:Math.floor(c.height/2)};var g=a.x;i.draw=function(){var l=$(f.votes()).map(function(n,o){return o.val()});var k=createPlotData(l);var m=createPointer(true);var j=[createPointer(true),createPointer(false)];$(k).each(function(n,o){h(o,m,j[n])})};function h(k,m,l){b.save();var n=d(m.degrees());var j=d(m.move(k.degrees));b.beginPath();b.moveTo(a.x,a.y);b.arc(a.x,a.y,g,n,j,false);b.closePath();b.strokeStyle="white";b.lineWidth=4;b.fillStyle=k.color;b.stroke();b.fill();b.restore();e(k,l)}function e(l,o){b.save();b.translate(a.x,a.y);var n=(-20);b.rotate(d(o.move(l.degrees+n)));var k=a.x-30;var j=Math.floor(a.y*0.05);b.translate(k,j);b.rotate(d(o.reset()));b.translate(-k,-j);b.textAlign="center";var m=Math.floor(g/25);b.font="bold 24px Helvetica";b.fillStyle="white";b.fillText(l.percentage,k,j);b.restore()}function d(j){return(j*Math.PI)/180}return i};var chartDom={canvas:function(){return $("canvas")[0]},votes:function(){return[$("#candidate-0-votes"),$("#candidate-1-votes")]}};function createClock(b){var a={};var c=b-(Date.parse(now())/1000);a.toString=function(){var d=Math.floor(c/3600);var e=Math.floor((c-(d*3600))/60);var f=Math.floor((c-(d*3600)-(e*60)));d=(d<10)?("0"+d):d.toString();e=(e<10)?("0"+e):e.toString();f=(f<10)?("0"+f):f.toString();return d+":"+e+":"+f};a.decrease=function(){--c};a.expired=function(){return !(c>0)};return a}function now(){return new Date()}function startCountdown(d,e){var b=setInterval(function(){d.decrease();a()},1000);a();function a(){d.expired()?c():f()}function f(){e.clock().html(d.toString())}function c(){e.message().hide();e.expired().show();clearInterval(b)}}var countdownDom={clock:function(){return $("#clock")},message:function(){return $("#countdown-wrapper p")},expired:function(){return $("#expired")},deadline:function(){return $("#deadline")}};$(document).ready(function(){createChart(chartDom).draw();var a=createClock(countdownDom.deadline().val());startCountdown(a,countdownDom)});